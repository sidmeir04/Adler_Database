<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <script src="bootstrap/js/bootstrap.bundle.min.js"></script>
    <title>Document</title>
    <style>
        .nav-pills .nav-link {
            cursor: pointer;
        }
        .form-section {
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <div class="caregiver_id" hidden value=""></div>
    <div class="enrollment_form_id" hidden value=""></div>
    <div class="medical_history_id" hidden value=""></div>
    <div class="ec1_id" hidden value=""></div>
    <div class="ec2_id" hidden value=""></div>
    <div class="container mt-5">
        <button><a class="nav-link" id="goToMembers" href="#">Members</a></button>
        <h2>Add Caregiver</h2>
    
        <!-- Navigation Menu -->
        <ul class="nav nav-pills mb-3" id="form-nav">
            <li class="nav-item"><a class="nav-link active" href="#" data-step="0">Caregiver Info</a></li>
            <li class="nav-item"><a class="nav-link" href="#" data-step="1">Medical History Form</a></li>
            <li class="nav-item"><a class="nav-link" href="#" data-step="2">Emergency Contact One</a></li>
            <li class="nav-item"><a class="nav-link" href="#" data-step="3">Emergency Contact Two</a></li>
        </ul>
    
        <form id="memberForm">
            <div class="form-step">
                <div class="mb-3">
                    <label for="caregiver_type" class="form-label">Caregiver Type</label>
                    <select class="form-select" id="caregiver_type" name="caregiver_type">
                        <option value="" selected disabled>Select Type</option>
                        <option value="family_caregiver">Family Caregiver</option>
                        <option value="paid_caregiver">Paid Caregiver</option>
                        <option value="friend_caregiver">Friend of Member</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="name" class="form-label">Name</label>
                    <input type="text" class="form-control" id="name" name="name">
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="email" name="email">
                </div>
                <div class="mb-3">
                    <label for="phone" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="phone" name="phone">
                </div>
                <div class="mb-3">
                    <label for="occupations" class="form-label">Occupations</label>
                    <input type="text" class="form-control" id="occupations" name="occupations">
                </div>
                <div class="mb-3">
                    <label for="allergies" class="form-label">Allergies</label>
                    <input type="text" class="form-control" id="allergies" name="allergies">
                </div>
                <div class="mb-3">
                    <label for="medications" class="form-label">Medications</label>
                    <input type="text" class="form-control" id="medications" name="medications">
                </div>
                <div class="mb-3">
                    <label for="sex" class="form-label">Gender</label>
                    <select class="form-select" id="sex" name="sex">
                        <option value="" selected disabled>Select Gender</option>
                        <option value="M">Male</option>
                        <option value="F">Female</option>
                        <option value="O">Other</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="member_id">Caregiver Of</label>
                    <input type="text" class="form-control" id="member_id" name="member_id">
                    <!-- <select class="form-select" id="member_id" name="member_id">
                        <option value="" selected disabled>Select Member</option>
                        Options will be populated dynamically -->
                </div>
                <div class="mb-3">
                    <label for="relationship">Relation to Member</label>
                    <input type="text" class="form-control" id="relationship" name="relationship">
                </div>
                <div class="mb-3">
                    <label for="notes">Notes</label>
                    <input type="text" class="form-control" id="notes" name="notes">
                </div>
                <button type="submit" class="btn btn-success">Add new Caregiver</button>
            </div>
        </form>

        <form id="MedicalHistoryForm">
            <div class="form-step d-none">
                <div class="mb-3">
                    <label for="anti_seizure_med" class="form-label">Anti Seizure Medication</label>
                    <select class="form-select" id="anti_seizure_med" name="anti_seizure_med">
                        <option value="" selected disabled>Select Option</option>
                        <option value="1">Yes</option>
                        <option value="0">No</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="aphasia_cause" class="form-label">Aphasia Cause</label>
                    <input type="text" class="form-control" id="aphasia_cause" name="aphasia_cause">
                </div>
                <div class="mb-3">
                    <label for="aphasia_onset" class="form-label">Aphasia Onset</label>
                    <input type="date" class="form-control" id="aphasia_onset" name="aphasia_onset">
                </div>
                <div class="mb-3">
                    <label for="completion_date" class="form-label">Completion Date</label>
                    <input type="date" class="form-control" id="completion_date" name="completion_date">
                </div>
                <div class="mb-3">
                    <label for="last_seizure_date" class="form-label">Last Seizure Date</label>
                    <input type="date" class="form-control" id="last_seizure_date" name="last_seizure_date">
                </div>
                <div class="mb-3">
                    <label for="lesion_location" class="form-label">Lesion Location</label>
                    <input type="text" class="form-control" id="lesion_location" name="lesion_location">
                </div>
                <div class="mb-3">
                    <label for="other_visual_impairments" class="form-label">Other Visual Impairments</label>
                    <textarea class="form-control" id="other_visual_impairments" name="other_visual_impairments" rows="3"></textarea>
                </div>
                <div class="mb-3">
                    <label for="physician_address" class="form-label">Physician Address</label>
                    <input type="text" class="form-control" id="physician_address" name="physician_address">
                </div>
                <div class="mb-3">
                    <label for="physician_phone" class="form-label">Physician Phone</label>
                    <input type="tel" class="form-control" id="physician_phone" name="physician_phone">
                </div>
                <div class="mb-3">
                    <label for="physicion_name" class="form-label">Physician Name</label>
                    <input type="text" class="form-control" id="physicion_name" name="physicion_name">
                </div>
                <div class="mb-3">
                    <label for="primary_diagnosis" class="form-label">Primary Diagnosis</label>
                    <textarea class="form-control" id="primary_diagnosis" name="primary_diagnosis" rows="3"></textarea>
                </div>
                <div class="mb-3">
                    <label for="secondary_diagnosis" class="form-label">Secondary Diagnosis</label>
                    <textarea class="form-control" id="secondary_diagnosis" name="secondary_diagnosis" rows="3"></textarea>
                </div>
                <div class="mb-3">
                    <label for="seizure_history" class="form-label">Seizure History</label>
                    <select class="form-select" id="seizure_history" name="seizure_history">
                        <option value="" selected disabled>Select Option</option>
                        <option value="1">Yes</option>
                        <option value="0">No</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="specialty" class="form-label">Specialty</label>
                    <input type="text" class="form-control" id="specialty" name="specialty">
                </div>
                <div class="mb-3">
                    <label for="stroke_location" class="form-label">Stroke Location</label>
                    <input type="text" class="form-control" id="stroke_location" name="stroke_location">
                </div>
                <label for="" class="form-label">Other Medical Conditions</label>
                <div class="other-condions">
                    <div class="mb-3">
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="diabetesCheckbox" name="diabetesCheckbox">
                            <label for="diabetesCheckbox">Diabetes</label>
                            <div id="diabetesDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="diabetesDetailsText" name="diabetesDetailsText" rows="3" placeholder="Provide details about diabetes"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="heartDiseaseCheckbox" name="heartDiseaseCheckbox">
                            <label for="heartDiseaseCheckbox">Heart Disease</label>
                            <div id="heartDiseaseDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="heartDiseaseDetailsText" name="heartDiseaseDetailsText" rows="3" placeholder="Provide details about heart disease"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="hypertensionCheckbox" name="hypertensionCheckbox">
                            <label for="hypertensionCheckbox">Hypertension</label>
                            <div id="hypertensionDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="hypertensionDetailsText" name="hypertensionDetailsText" rows="3" placeholder="Provide details about hypertension"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="brainSurgeryCheckbox" name="brainSurgeryCheckbox">
                            <label for="brainSurgeryCheckbox">Brain Surgery</label>
                            <div id="brainSurgeryDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="brainSurgeryDetailsText" name="brainSurgeryDetailsText" rows="3" placeholder="Provide details about brain surgery"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="memoryImpairmentCheckbox" name="memoryImpairmentCheckbox">
                            <label for="memoryImpairmentCheckbox">Memory Impairment</label>
                            <div id="memoryImpairmentDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="memoryImpairmentDetailsText" name="memoryImpairmentDetailsText" rows="3" placeholder="Provide details about memory impairment"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="clinicalDepressionCheckbox" name="clinicalDepressionCheckbox">
                            <label for="clinicalDepressionCheckbox">Clinical Depression</label>
                            <div id="clinicalDepressionDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="clinicalDepressionDetailsText" name="clinicalDepressionDetailsText" rows="3" placeholder="Provide details about clinical depression"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="psychiatricProblemsCheckbox" name="psychiatricProblemsCheckbox">
                            <label for="psychiatricProblemsCheckbox">Psychiatric Problems</label>
                            <div id="psychiatricProblemsDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="psychiatricProblemsDetailsText" name="psychiatricProblemsDetailsText" rows="3" placeholder="Provide details about psychiatric problems"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="alcoholAbuseCheckbox" name="alcoholAbuseCheckbox">
                            <label for="alcoholAbuseCheckbox">Alcohol Abuse/Problems</label>
                            <div id="alcoholAbuseDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="alcoholAbuseDetailsText" name="alcoholAbuseDetailsText" rows="3" placeholder="Provide details about alcohol abuse/problems"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="substanceAbuseCheckbox" name="substanceAbuseCheckbox">
                            <label for="substanceAbuseCheckbox">Substance Abuse</label>
                            <div id="substanceAbuseDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="substanceAbuseDetailsText" name="substanceAbuseDetailsText" rows="3" placeholder="Provide details about substance abuse"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="dementia2Checkbox" name="dementia2Checkbox">
                            <label for="dementia2Checkbox">Dementia</label>
                            <div id="dementia2Details" class="mt-2 d-none">
                                <textarea class="form-control" id="dementia2DetailsText" name="dementia2DetailsText" rows="3" placeholder="Provide details about dementia"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="parkinsonsCheckbox" name="parkinsonsCheckbox">
                            <label for="parkinsonsCheckbox">Parkinson's Disease</label>
                            <div id="parkinsonsDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="parkinsonsDetailsText" name="parkinsonsDetailsText" rows="3" placeholder="Provide details about Parkinson's disease"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="epilepsy2Checkbox" name="epilepsy2Checkbox">
                            <label for="epilepsy2Checkbox">Epilepsy/Seizure Disorder</label>
                            <div id="epilepsy2Details" class="mt-2 d-none">
                                <textarea class="form-control" id="epilepsy2DetailsText" name="epilepsy2DetailsText" rows="3" placeholder="Provide details about epilepsy/seizure disorder"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="neurologicalDiseaseCheckbox" name="neurologicalDiseaseCheckbox">
                            <label for="neurologicalDiseaseCheckbox">Other Neurological Disease</label>
                            <div id="neurologicalDiseaseDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="neurologicalDiseaseDetailsText" name="neurologicalDiseaseDetailsText" rows="3" placeholder="Provide details about other neurological disease"></textarea>
                            </div>
                        </div>
                        <div class="mb-3" style="margin-bottom: 2px;">
                            <input type="checkbox" id="majorIllnessCheckbox" name="majorIllnessCheckbox">
                            <label for="majorIllnessCheckbox">Other Major Illness</label>
                            <div id="majorIllnessDetails" class="mt-2 d-none">
                                <textarea class="form-control" id="majorIllnessDetailsText" name="majorIllnessDetailsText" rows="3" placeholder="Provide details about other major illness"></textarea>
                            </div>
                        </div>
                        <script>
                            const checkboxes = [
                                'diabetes', 'heartDisease', 'hypertension', 'brainSurgery', 'memoryImpairment', 
                                'clinicalDepression', 'psychiatricProblems', 'alcoholAbuse', 
                                'substanceAbuse', 'dementia2', 'parkinsons', 'epilepsy2', 
                                'neurologicalDisease', 'majorIllness'
                            ];
                            checkboxes.forEach(id => {
                                document.getElementById(`${id}Checkbox`).addEventListener('change', function() {
                                    const detailsDiv = document.getElementById(`${id}Details`);
                                    if (this.checked) {
                                        detailsDiv.classList.remove('d-none');
                                    } else {
                                        detailsDiv.classList.add('d-none');
                                    }
                                });
                            });
                        </script>
                    </div>
                </div>
                <button type="submit" class="btn btn-success">Add new member</button>
            </div>
        </form>

        <form id="EC1">
            <div class="form-step d-none">
                <div class="mb-3">
                    <label for="name" class="form-label">Contact Name</label>
                    <input type="text" class="form-control" id="name" name="name">
                </div>
                <div class="mb-3">
                    <label for="relationship" class="form-label">Relation to Member</label>
                    <input type="text" class="form-control" id="relationship" name="relationship">
                </div>
                <div class="mb-3">
                    <label for="cell_phone" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="cell_phone" name="cell_phone">
                </div>
                <div class="mb-3">
                    <label for="day_phone" class="form-label">Day Phone</label>
                    <input type="tel" class="form-control" id="day_phone" name="day_phone">
                </div>
                <div class="mb-3">
                    <label for="evening_phone" class="form-label">Evening Phone</label>
                    <input type="tel" class="form-control" id="evening_phone" name="evening_phone">
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="email" name="email">
                </div>
                <div class="mb-3">
                    <label for="address" class="form-label">Address</label>
                    <input type="text" class="form-control" id="address" name="address">
                </div>
                <button type="submit" class="btn btn-success">Create Emergency Contact One</button>
            </div>
        </form>

        <form id="EC2">
            <div class="form-step d-none">
                <div class="mb-3">
                    <label for="name" class="form-label">Contact Name</label>
                    <input type="text" class="form-control" id="name" name="name">
                </div>
                <div class="mb-3">
                    <label for="relationship" class="form-label">Relation to Member</label>
                    <input type="text" class="form-control" id="relationship" name="relationship">
                </div>
                <div class="mb-3">
                    <label for="cell_phone" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="cell_phone" name="cell_phone">
                </div>
                <div class="mb-3">
                    <label for="day_phone" class="form-label">Day Phone</label>
                    <input type="tel" class="form-control" id="day_phone" name="day_phone">
                </div>
                <div class="mb-3">
                    <label for="evening_phone" class="form-label">Evening Phone</label>
                    <input type="tel" class="form-control" id="evening_phone" name="evening_phone">
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="email" name="email">
                </div>
                <div class="mb-3">
                    <label for="address" class="form-label">Address</label>
                    <input type="text" class="form-control" id="address" name="address">
                </div>
                <button type="submit" class="btn btn-success">Create Emergency Contact Two</button>
            </div>
        </form>
    </div>

    <script>
        document.getElementById('memberForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const formObject = {};
            formData.forEach((value, key) => {
                formObject[key] = value;
            });
            formObject['id'] = getMemberID();
            const jsonString = JSON.stringify(formObject, null, 2);
            console.log(jsonString);
            if(getMemberID() == undefined || getMemberID() == '') {
                window.addCaregiver(jsonString).then(function(id) {
                    console.log("Returned ID:", id);
                    updateMemberID(id);
                    alert("Caregiver added successfully!");
                }).catch(function(error) {
                    console.log(id);
                    console.error("Error:", error);
                });
            } else {
                window.updateCaregiver(jsonString);
                alert("Caregiver updated successfully.");
            }
        });
        document.getElementById('MedicalHistoryForm').addEventListener('submit', function(event) {
            event.preventDefault();
            if(getMemberID() == undefined || getMemberID() == '') {
                alert("Please save the member information first before adding emergency contact details.");
                console.error("Member ID not set");
                return;
            }
            const formData = new FormData(event.target);
            const formObject = {};
            formData.forEach((value, key) => {
                if (!checkboxes.some(id => key.startsWith(id))) {
                    formObject[key] = value;
                }
            });
            const otherMedicalConditions = {};
            checkboxes.forEach(id => {
                const checkbox = document.getElementById(`${id}Checkbox`);
                const detailsText = document.getElementById(`${id}DetailsText`);
                if (checkbox.checked) {
                    otherMedicalConditions[id] = detailsText.value || null;
                }
            });
            formObject['other_medical_conditions'] = otherMedicalConditions;
            formObject['id'] = getMedicalHistoryID();
            const jsonString = JSON.stringify(formObject, null, 2);
            console.log(jsonString);
            // need to add code to also update the member's emergency contact ID
            if(getMedicalHistoryID() == undefined || getMedicalHistoryID() == '') {
                window.addMedicalHistory(jsonString).then(function(id) {
                    console.log("Returned ID:", id);
                    updateMedicalHistoryID(id);
                    const payload = JSON.stringify({
                        "id": getMemberID()[0],
                        "medical_history": id
                    });

                    console.log("Payload:", payload);
                    window.updateCaregiver(payload);
                    alert("Medical History updated successfully.");
                }).catch(function(error) {
                    console.error("Error:", error, "at line:", error.lineNumber || "unknown");
                });
            } else {
                window.updateMedicalHistory(jsonString);
                alert("Medical History updated successfully.");
            }
        });
        document.getElementById('EC1').addEventListener('submit', function(event) {
            event.preventDefault();
            if(getMemberID() == undefined || getMemberID() == '') {
                alert("Please save the member information first before adding emergency contact details.");
                console.error("Member ID not set");
                return;
            }
            const formData = new FormData(event.target);
            const formObject = {};
            formData.forEach((value, key) => {
                formObject[key] = value;
            });
            formObject['id'] = getEC1ID();
            const jsonString = JSON.stringify(formObject, null, 2);
            console.log(jsonString);
            // need to add code to also update the member's emergency contact ID
            if(getEC1ID() == undefined || getEC1ID() == '') {
                window.addEC(jsonString).then(function(id) {
                    console.log("Returned ID:", id);
                    updateEC1ID(id);
                    const payload = JSON.stringify({
                        "id": getMemberID()[0],
                        "emergency_contact_one": id
                    });

                    console.log("Payload:", payload);
                    window.updateCaregiver(payload);
                    alert("Emergency Contact One updated successfully.");
                }).catch(function(error) {
                    console.error("Error:", error);
                });
            } else {
                window.updateEC(jsonString);
                alert("Emergency Contact One updated successfully.");
            }
        });
        document.getElementById('EC2').addEventListener('submit', function(event) {
            event.preventDefault();
            if(getMemberID() == undefined || getMemberID() == '') {
                alert("Please save the member information first before adding emergency contact details.");
                console.error("Member ID not set");
                return;
            }
            const formData = new FormData(event.target);
            const formObject = {};
            formData.forEach((value, key) => {
                formObject[key] = value;
            });
            formObject['id'] = getEC2ID();
            const jsonString = JSON.stringify(formObject, null, 2);
            console.log(jsonString);
            if(getEC2ID() == undefined || getEC2ID() == '') {
                window.addEC(jsonString).then(function(id) {
                    console.log("Returned ID:", id);
                    updateEC2ID(id);
                    const payload = JSON.stringify({
                        "id": getMemberID()[0],
                        "emergency_contact_two": id
                    });

                    window.updateCaregiver(payload);
                    alert("Emergency Contact Two updated successfully.");
                }).catch(function(error) {
                    console.log(id);
                    console.error("Error:", error);
                });
            } else {
                window.updateEC(jsonString);
                alert("Emergency Contact Two updated successfully.");
            }
        });
        document.addEventListener("DOMContentLoaded", function () {
            const steps = document.querySelectorAll(".form-step");
            const navLinks = document.querySelectorAll("#form-nav .nav-link");
            let currentStep = 0;

            function showStep(stepIndex) {
                steps.forEach((step, index) => {
                    step.classList.toggle("d-none", index !== stepIndex);
                });
                navLinks.forEach((link, index) => {
                    link.classList.toggle("active", index === stepIndex);
                });
            }

            // Navigation Menu Click Handling
            navLinks.forEach((link) => {
                link.addEventListener("click", function (e) {
                    e.preventDefault();
                    const stepIndex = parseInt(this.getAttribute("data-step"));
                    currentStep = stepIndex;
                    showStep(currentStep);
                });
            });

            showStep(currentStep);
        });

        function initializeFormData(jsonString){
            console.log(jsonString);
            const data = JSON.parse(jsonString);

            const memberData = data.userData;
            const memberForm = document.getElementById('memberForm');
            document.querySelector('.caregiver_id').value = memberData.id;
            memberForm.querySelector('#caregiver_type').value = memberData.caregiver_type;
            memberForm.querySelector('#name').value = memberData.name;
            memberForm.querySelector('#email').value = memberData.email;
            memberForm.querySelector('#phone').value = memberData.phone;
            memberForm.querySelector('#occupations').value = memberData.occupations;
            memberForm.querySelector('#allergies').value = memberData.allergies;
            memberForm.querySelector('#medications').value = memberData.medications;
            memberForm.querySelector('#sex').value = memberData.sex;
            memberForm.querySelector('#member_id').value = memberData.member_id;
            memberForm.querySelector('#relationship').value = memberData.relationship;
            memberForm.querySelector('#notes').value = memberData.notes;

            const medicalHistoryData = data.medicalData;
            const medicalHistoryForm = document.getElementById('MedicalHistoryForm');
            document.querySelector('.medical_history_id').value = medicalHistoryData.id;
            medicalHistoryForm.querySelector('#anti_seizure_med').value = medicalHistoryData.anti_seizure_med;
            medicalHistoryForm.querySelector('#aphasia_cause').value = medicalHistoryData.aphasia_cause;
            medicalHistoryForm.querySelector('#aphasia_onset').value = medicalHistoryData.aphasia_onset;
            medicalHistoryForm.querySelector('#completion_date').value = medicalHistoryData.completion_date;
            medicalHistoryForm.querySelector('#last_seizure_date').value = medicalHistoryData.last_seizure_date;
            medicalHistoryForm.querySelector('#lesion_location').value = medicalHistoryData.lesion_location;
            medicalHistoryForm.querySelector('#other_visual_impairments').value = medicalHistoryData.other_visual_impairments;
            medicalHistoryForm.querySelector('#physician_address').value = medicalHistoryData.physician_address;
            medicalHistoryForm.querySelector('#physician_phone').value = medicalHistoryData.physician_phone;
            medicalHistoryForm.querySelector('#physicion_name').value = medicalHistoryData.physicion_name;
            medicalHistoryForm.querySelector('#primary_diagnosis').value = medicalHistoryData.primary_diagnosis;
            medicalHistoryForm.querySelector('#secondary_diagnosis').value = medicalHistoryData.secondary_diagnosis;
            medicalHistoryForm.querySelector('#seizure_history').value = medicalHistoryData.seizure_history;
            medicalHistoryForm.querySelector('#specialty').value = medicalHistoryData.specialty;
            medicalHistoryForm.querySelector('#stroke_location').value = medicalHistoryData.stroke_location;
            if (medicalHistoryData.other_medical_conditions.length > 0) {
                console.log(medicalHistoryData.other_medical_conditions);
                const otherMedicalConditions = JSON.parse(medicalHistoryData.other_medical_conditions) || {};
                checkboxes.forEach(id => {
                    const checkbox = document.getElementById(`${id}Checkbox`);
                    const detailsText = document.getElementById(`${id}DetailsText`);
                    if (otherMedicalConditions[id]) {
                        checkbox.checked = true;
                        detailsText.value = otherMedicalConditions[id];
                        detailsText.parentElement.classList.remove('d-none');
                    } else {
                        checkbox.checked = false;
                        detailsText.value = '';
                        detailsText.parentElement.classList.add('d-none');
                    }
                });
            }

            const ec1Data = data.emergencyContactOne;
            const ec1Form = document.getElementById('EC1');
            document.querySelector('.ec1_id').value = ec1Data.id;
            ec1Form.querySelector('#name').value = ec1Data.name;
            ec1Form.querySelector('#relationship').value = ec1Data.relationship;
            ec1Form.querySelector('#cell_phone').value = ec1Data.cell_phone;
            ec1Form.querySelector('#day_phone').value = ec1Data.day_phone;
            ec1Form.querySelector('#evening_phone').value = ec1Data.evening_phone;
            ec1Form.querySelector('#email').value = ec1Data.email;
            ec1Form.querySelector('#address').value = ec1Data.address;

            const ec2Data = data.emergencyContactTwo;
            const ec2Form = document.getElementById('EC2');
            document.querySelector('.ec2_id').value = ec2Data.id;
            ec2Form.querySelector('#name').value = ec2Data.name;
            ec2Form.querySelector('#relationship').value = ec2Data.relationship;
            ec2Form.querySelector('#cell_phone').value = ec2Data.cell_phone;
            ec2Form.querySelector('#day_phone').value = ec2Data.day_phone;
            ec2Form.querySelector('#evening_phone').value = ec2Data.evening_phone;
            ec2Form.querySelector('#email').value = ec2Data.email;
            ec2Form.querySelector('#address').value = ec2Data.address;
        }

        
        function updateMemberID(id) {
            document.querySelector('.caregiver_id').value = id;
        }
        function getMemberID() {
            return document.querySelector('.caregiver_id').value;
        }
        function updateEnrollmentFormID(id) {
            document.querySelector('.enrollment_form_id').value = id;
        }
        function getEnrollmentFormID() {
            return document.querySelector('.enrollment_form_id').value;
        }
        function updateMedicalHistoryID(id) {
            document.querySelector('.medical_history_id').value = id;
        }
        function getMedicalHistoryID() {
            return document.querySelector('.medical_history_id').value;
        }
        function updateEC1ID(id) {
            document.querySelector('.ec1_id').value = id;
        }
        function getEC1ID() {
            return document.querySelector('.ec1_id').value;
        }
        function updateEC2ID(id) {
            document.querySelector('.ec2_id').value = id;
        }
        function getEC2ID() {
            return document.querySelector('.ec2_id').value;
        }
        document.getElementById("goToMembers").addEventListener("click", function() {
            window.loadMembers();
        });
    </script>
</body>
</html>
